---
import { Image } from "astro:assets";
import '@styles/index.css'
import logo from '@images/logo.jpg';
import { SITE_TITLE, SITE_DESCRIPTION } from 'src/consts';
import {Members, Posts, Categories} from "@content/config";
import Layout from '@layouts/Default.astro';
import { getCollection, getEntryBySlug } from "astro:content";
import DateLocale from '@components/DateLocale.astro';

const posts = await getCollection("posts");

const hasImageAttribution = (post: Posts) => {
  return post.data.img.attribution !== undefined;
};

---
<Layout title={SITE_TITLE} description={ SITE_DESCRIPTION }>
  <h2>Latest Posts</h2>
  <div class="index-list-posts">
    {
      posts
        // Exclude drafts.
      .filter((post: Posts) => post.data.draft !== true)
        // Sort posts by date.
      .sort((a: Posts, b: Posts) => b.data.datePublished - a.data.datePublished)
        .map((post: Posts) => (
          <div>
            {
              <Image src={post.data.img.src} alt={post.data.img.alt} />
              <a href={`/blog/posts/${post.slug}`}><h3>{post.data.title}</h3></a>

              <p>{post.data.description}</p>
              <DateLocale date={post.data.datePublished} omitYear={true}/>
            }
          </div>
        ))
    }
    {
  /*
      posts.filter((post: Posts) => post.data.draft !== true).sort((a: Posts, b: Posts) => b.data.datePublished - a.data.datePublished).map((post: Posts) => (
      <div>{
        <Image src={post.data.img.src} alt={post.data.img.alt}/><h3>{post.data.title}</h3><p>{post.data.description}</p>
        <DateLocale date={post.data.datePublished} omitYear={true}/>}</div>))
  */
    }
  </div>
</Layout>